<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>TheMNISTDataSet.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>TheMNISTDataSet</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/index-BXqkmYCF.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/preload-helper-BnutJmlU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/chunk-DZLz74EQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/react-BcIddLXZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/compiler-runtime-Cr9loedd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/jsx-runtime-mwDPpfh_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/useEventListener-D1FLsfmf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/react-dom-D6bRRS5R.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/Combination-BjaZc6gK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/clsx-BlAkgCmw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/cn-ZXtYmczU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/menu-items-DwOFR2Zi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/hotkeys-ClCtr3_I.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/button-ZC2axIBq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dist-o-4-WxUj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/createLucideIcon-CNVopWor.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/check-CuBLr6Cm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/select-5fcaZwou.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/multi-map-D9JaQ_m6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/chevron-right-BV0VfNbL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dropdown-menu-uN_XMhZm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/tooltip-BHnVWzH0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/_Uint8Array-D5Z9rM2X.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/_getTag-CVRrQL_Q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/_baseIsEqual-CVFfFJm2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/jotai-BTnrNcC1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/invariant-D5a0EE05.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/isArrayLikeObject-DKyJYtr8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/merge-Dvc5opZF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/zod-U2NFpcFA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/utils-DEDX0RLo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/requests-BACZP_uj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/once-C5bmD4W5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/toDate-C3oOx2yr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/_baseSlice-BWZ0PeaJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/_arrayMap-DQI2GUNb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/isSymbol-xTSywenE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/toString-CBnct2wx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/_hasUnicode-3DIK_jNi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/upperFirst-CBQfDRod.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/capitalize-CBqvgOfA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/ai-model-dropdown-CvhbTHha.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/badge-Jfhpc30N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/use-toast-midBZAtS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/constants-CEISdYm1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/Deferred-NfAvvkGM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/config-C6qInAhC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/uuid-D0hUC3Qw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/key-Cx1qY8eM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/connection-Bs4SQ_vu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/useLifecycle-DogGOXPh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/useNonce-VIoWEX5z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/capabilities-srilPYuF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/createReducer-CeLhipaI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dist-MHIqsPCF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dist-8_YHxBVW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dist-CbvGwhr0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dist-CPUmJw_F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dist-DcDuMWp5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dist-DJV2CjUA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dist-C14Sk-Bd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dist-vBG1bGij.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dist-Oad1venD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/stex-xveX5l_T.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/cjs-Ck8KMDI1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/_baseProperty-c4IQJQis.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/toNumber-CTOPJrpu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/now-BXqTLlmI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/debounce-BUM2losY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/toInteger-Bor4StOs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/type-o43RKOcp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/marked.esm-BV7g2d65.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/main-ChjX94eX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/cells-A69p56PE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/kbd-DbVT085u.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/renderShortcut-DJmsjON-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/useEvent-CRDKqG3C.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/useDeleteCell-CEsjHDdl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/lazy-oPCv0nK8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/defaultLocale-YmL2k7Vp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/precisionRound-Qxa8hC2h.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/defaultLocale-zQltfbSS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/vega-loader.browser-D2m26-DP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/tooltip-BFMRXuzR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/ErrorBoundary-_uEOjNWh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/alert-dialog-8EwWlboa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dialog-BfhgTWm1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/useDebounce-DzG_89QJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/numbers-CTSqyVyD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/SSRProvider-B8x7qo1c.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/context-CcLKJeA2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/useNumberFormatter-F8R3LBxf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/usePress-BO20vkQb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/input-BNb8K99m.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/ImperativeModal-C4fZHLKz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/cell-link-D75IV6D1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/alert-BqjCH_7t.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/links-CMl0qG9J.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/state-JZFfOGr9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/MarimoErrorOutput-BATnwNYX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/spinner-CuquyDWA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/_arrayReduce-DV4IVFuG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/startCase-RfubwhHM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/strings-DHsDEFo-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/command-Dlk4i3l7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/popover-F0Sfc1dn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/useRunCells-BLpH_l8E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/copy-LsxoSTiV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/copy-Dy_tLkL8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/copy-icon-CE7wmMnS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/mode-Bq6LjPC-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/purify.es-CPMOFAIu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/RenderHTML-DTLkV9Uh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/table-DU76OrPF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/tabs-l9npw3ob.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/useAsyncData-CngUoIwV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/useIframeCapabilities-DXQ78nsN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/error-banner-DoSAS3iD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/formats-BN93kMCb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/useTheme-Biy2QI0v.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/en-US-D2gH55FJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/isValid-BJSfXqfd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/maps-B1z3jt-a.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/shim-Cc3VMan6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/download-ByFIcaoi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/extends-dwNt6GDg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/emotion-is-prop-valid.esm-OoyWz_0l.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/useDateFormatter-CPDTrKqK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/range-ZclXTdAh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/table-C2gUjtJV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/Output-DWmT-7NV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/name-cell-input-DND1MD7b.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/useHotkey-NDxGNWnW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/objectWithoutPropertiesLoose-COpOcp6W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/esm-B3nKz9z-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dist-GE2AwHvG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dist-CMHCymvx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dist-ta4iJSan.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dist-BcppZLnk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dist-DRTi9ht4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dist-BjGT2Oog.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dist-CXL8T4lt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dist-B0B_Xnwd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dist-BcgNLefj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dist-j2I9I0a7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dist-DM2w8f7r.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dist-nhBdVy6b.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dist-D-JTXier.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/apl-BGS-6pM9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/asciiarmor-CbQH35y7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/asn1-P7HrFGaM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/brainfuck-CSxeyQc4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/clike-Bg9duJDo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/clojure-B94DOmFw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/cmake-DQEKyMNG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/cobol-CY4gVoPW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/coffeescript-BwWb96Ts.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/commonlisp-Cq_n1sF6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/crystal-BLTq7Sqq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/css-CmDcdojQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/cypher-ByytCYVx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/d-xLFRg71F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/diff-VF6GbDch.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dtd-D8qb8bJW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dylan-CIkom9X4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/ecl-8wcmTiom.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/eiffel-D2ZBcT03.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/elm-Cpg3TnMc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/erlang-B4A2pXCG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/simple-mode-BrL6eoj-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/factor-DhbRkYZ5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/forth-C5F1F4pC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/fortran-D7Gl3Tli.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/gas-BS2f8qHc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/gherkin-CVZcskwU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/groovy-BhQsBMwW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/haskell-BPbxlKgK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/haxe-TKSAmiMf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/idl-DFgQu5Ek.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/javascript-dAA8UGkz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/jinja2-BIbcpWyF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/julia-CfdFJG3K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/livescript-FcXY3DYa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/lua-Co6rjiMf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/mathematica-yb42KhnJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/mbox-Kdy3h0JS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/mirc-DIfBuSAc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/mllike-ClozcVVR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/modelica-DfSVZeoi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/mscgen-BCcB4vmY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/mumps-Zs7zFruB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/nsis-znELVT3h.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/ntriples-BZ-Gx5MV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/octave-DbhnFGQl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/oz-C8cfEyhB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/pascal-DjQLfZxE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/perl-BbHwsgL1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/pig-siFNrhhJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/powershell-DtGrdgtc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/properties-ThqBcpfC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/protobuf-RiYv9VfD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/pug-DUVdXXqU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/puppet-U5CQLRYv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/python-Bwt6zAaD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/q-DIhdXtBp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/r-CWawXx6U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/rpm-CNr8ALvx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/ruby-DskfS84U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/sas-C2b2tSOH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/scheme-Cmmcrp64.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/shell-Dyv1aCg9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/sieve-B_dGzCIS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/smalltalk-intFzbz6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/sparql-BX1c9HJU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/stylus-X6xt1FMB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/swift-BYNJXGdg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/tcl-BaybuQuE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/textile-77KFAyfi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/toml-D6E8t1IG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/troff-BfktZMhT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/ttcn-cfg-CstA0KVC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/ttcn-DOlRqUFL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/turtle-Cx-tHjh2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/vb-DerFRxqu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/vbscript-BPEY3B7J.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/velocity-B-lFP8Gk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/verilog-C9TzcLDl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/vhdl-v8a_uH2H.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/webidl-DmZw40AA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/xquery-BrIWpdRx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/yacas-ofPECLUx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/z80-DrGVKC-O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/esm-DtCFmQ1n.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/trash-CRcefzxk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/ConsoleOutput-BJP_UIwR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/icons-DaFojEUL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/add-missing-import-Bc1Nj8aC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/blob-ISoY06EG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/add-cell-with-ai-Bf3hYYIu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/chart-no-axes-column-DYZiSI6e.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/square-function-sjebOKTF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/spec-C5SzKl5N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/focus-BaSDCTOl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/useInstallPackage-I3kefbOO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/column-preview-WPlkULp9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/useAddCell-CREgcbTt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/toggle-DlfY8wql.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/api-YJHlT7KM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/globals-Dp5TPAWC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/share-8z32Sr0F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/dist-DBrqGLzW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/memoize-DhF8x4Aa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/_toKey-16owuO_q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/_baseSet-L2qemYhz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/utilities.esm-Bjl8-mRM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/floating-outline-1_-JOoBX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/eye-off-_Bp7Ir5E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/plus-CRGccegF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/readonly-python-code-B4MS39iL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/file-video-camera-DJUITpag.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/file-text-CFgIi1A4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/file-Cz8xVTWu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/types-Bh2kSb2q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/label-Dcu3RhQ4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/form-CaSJmn0I.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/textarea-DeG5mMSH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/circle-x-Dm9uA-wT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/refresh-ccw-Dg4gNnPm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/trash-2-BPux4_UF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/form-DaO98mWt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/field-CaHPDBhq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/switch-4s4187gV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/useBoolean-CpaqzlKu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/useDeepCompareMemoize-DiJVYA6I.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/LazyAnyLanguageCodeMirror-BovGLUi6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/types-CHAkS4Oz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/prop-types-Dr_68tMt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/es-vLBD1nBl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/VisuallyHidden-DqOWapbP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/_baseFlatten-ViL-mfkw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/get-BUGWIXZE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/hasIn-BgJKauE7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/_basePickBy-CSDa7ReR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/pick-BQzWKfma.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/square-CYRwTwZO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/download-ptuQ0M1w.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/globe-mi3m-i9B.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/send-CTRovYct.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/refresh-cw-Duwwh0cP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/settings-p8vTgdrN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/bundle.esm-BEDtDq85.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/cells-BvrC6Bsv.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/Output-j3zW187k.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/ConsoleOutput-BFFTcC5Y.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.7/dist/assets/index-BmcO-QYJ.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "TheMNISTDataSet.py",
            "mode": "read",
            "version": "0.17.7",
            "serverToken": "static",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "above", "code_editor_font_size": 14, "custom_css": [], "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "full", "reference_highlighting": false, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "uv"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "full"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "mo.md(r\"\"\"\n## The MNIST Dataset\n\nThe MNIST dataset (Modified National Institute of Standards and Technology) is one of the most popular datasets used in machine learning and computer vision. It consists of a large collection of grey scale images of handwritten digits (0\u20139), which is widely used for training and testing in image processing and classification tasks.\n\nThe dataset contains 60,000 training images and 10,000 testing images. Each image is a 28x28 pixel square (784 pixels in total) with pixel values ranging from 0 to 255. The dataset is divided into 10 classes, one for each digit.\n\nIt is so common that most machine learning libraries provide a built-in function to download and load the dataset. For example the torchvision library in PyTorch provides a built-in function to download and load the MNIST dataset.\n\nHowever in this notebook we are going to download and process the images from source as this will provide a deeper understating of data sets in general and how they are processed in machine learning.\n\n## Setup\n\nTo start with we are going to import the libraries we need including our Utils library which contains some helper functions to download datasets. We will also see if we are in the lab and if so we will download the data to the local file system (/transfer). If we are not in the lab we will download the data to the current working directory.\n\"\"\")", "code_hash": "8ab09d37d87315f0d690e7bf1064ab2c", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Hbol", "name": "_"}, {"code": "import pathlib\nimport struct\nimport sys\n\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport mlutils\n\nprint(f\"{mlutils.in_lab()=}\")", "code_hash": "5d1e5f930a499d5a810ecd97f1a6a884", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MJUe", "name": "_"}, {"code": "mo.md(r\"\"\"\nWe will define a download location for the data, then use the download function to download it all. The data is split into training and testing data so we will download both. In this case as the data is self contained in a single file we will download it all into a single folder. If we we were downloading a dataset that was split into multiple files we would download each file into a separate folder.\n\"\"\")", "code_hash": "da72b7275893815aa3272aef93b05b8c", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "vblA", "name": "_"}, {"code": "DATASET_LOCATION = \"\"\nif mlutils.in_lab():\n    DATASET_LOCATION = \"/transfer/MNIST_Dataset/\"\nelse:\n    DATASET_LOCATION = \"./MNIST_Dataset/\"\n# now we will create the folder if it does not exist\npathlib.Path(DATASET_LOCATION).mkdir(parents=True, exist_ok=True)", "code_hash": "5b3d56a779c9c8f1004bbbf48697f856", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bkHC", "name": "_"}, {"code": "mo.md(r\"\"\"\nWe can use the [pathlib](https://docs.python.org/3/library/pathlib.html) module to do most of the work we need for file processing. In the case above we will create a new folder in the location we defined. If the folder already exists we will ignore it.\n\nNext we are going to download the data, however we only really want to download it if it is not already present. We can use the pathlib module to check if the file exists and only download it if it does not. The files we are looking for are :\n\n    - train-images-idx3-ubyte.gz:  training set images\n    - train-labels-idx1-ubyte.gz:  training set labels\n    - t10k-images-idx3-ubyte.gz:   test set images\n    - t10k-labels-idx1-ubyte.gz:   test set labels\n\nWe will download them from the google mirror outlined here https://github.com/cvdfoundation/mnist\n\"\"\")", "code_hash": "8932e609d1aa3ab5fa3c0ac7636ae6d5", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "lEQa", "name": "_"}, {"code": "files = [\n    \"train-images-idx3-ubyte.gz\",\n    \"train-labels-idx1-ubyte.gz\",\n    \"t10k-images-idx3-ubyte.gz\",\n    \"t10k-labels-idx1-ubyte.gz\",\n]\nURL = \"https://storage.googleapis.com/cvdf-datasets/mnist/\"\nfor _file in files:\n    if not pathlib.Path(DATASET_LOCATION + _file).exists():\n        print(f\"Downloading {_file}\")\n        mlutils.download(f\"{URL}{_file}\", DATASET_LOCATION + _file)", "code_hash": "70976f73b4905b2ef612fb72a46a52d4", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PKri", "name": "_"}, {"code": "mo.md(r\"\"\"\nThe downloaded files are compressed using gzip we need to uncompress them before we can use them. We can use the gzip module to do this.\n\"\"\")", "code_hash": "ca29cc1c6022a80cb796e218f26c3062", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Xref", "name": "_"}, {"code": "import gzip\n\nfor _file in files:\n    if not pathlib.Path(DATASET_LOCATION + _file[:-3]).exists():\n        print(f\"Unzipping {_file}\")\n        with gzip.open(DATASET_LOCATION + _file, \"rb\") as f_in:\n            with open(DATASET_LOCATION + _file[:-3], \"wb\") as f_out:\n                f_out.write(f_in.read())", "code_hash": "2b88bb20b2081a51df7e4ecfde2ff4c8", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SFPL", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Data Format\n\nNow we have downloaded the data we need to understand the format of the data. The data is stored in a binary format which is not human readable. The data is stored in a format called IDX which is a simple format for vectors and multidimensional matrices of various numerical types. The IDX file format is a simple format for vectors and multidimensional matrices of various numerical types. The basic format is\n\n    magic number\n    size in dimension 0\n    size in dimension 1\n    size in dimension 2\n    .....\n    size in dimension N\n    data\n\nIn particular the MNIST is formatted as follows :\n\n```\nLabels\n[offset] [type]          [value]          [description]\n0000     32 bit integer  0x00000801(2049) magic number (MSB first)\n0004     32 bit integer  60000            number of items\n0008     unsigned byte   ??               label\n0009     unsigned byte   ??               label\n........\nxxxx     unsigned byte   ??               label\n\nThe labels values are 0 to 9.\n```\n\nAnd for the images\n\n```\n IMAGE FILE FORMAT\n[offset] [type]          [value]          [description]\n0000     32 bit integer  0x00000803(2051) magic number\n0004     32 bit integer  60000            number of images\n0008     32 bit integer  28               number of rows\n0012     32 bit integer  28               number of columns\n0016     unsigned byte   ??               pixel\n0017     unsigned byte   ??               pixel\n........\nxxxx     unsigned byte   ??               pixel\n\nPixels are organized row-wise. Pixel values are 0 to 255. 0 means background (white), 255 means foreground (black).\n```\n\nWe can write python functions to extract the data and convert it into numpy arrays, one for the image data and one for the labels. We can then use the matplotlib library to display the images.\n\n## Loading Labels\n\nWe are going to use the python ```struct``` module to read the header data then skip the header and read the rest of the data. We can then convert the data into a numpy array.\n\nNote there is minimal error checking in this code, it is assumed the data is in the correct format, however we should be able to check the size of the data and the number of labels to ensure they match.\n\"\"\")", "code_hash": "a0473a00f065c4fd9d05b701fea1beeb", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "BYtC", "name": "_"}, {"code": "def load_mnist_labels(filename: str) -\u003E np.ndarray:\n    with open(filename, \"rb\") as f:\n        magic, num = struct.unpack(\"\u003EII\", f.read(8))\n        labels = np.fromfile(f, dtype=np.uint8)\n        if len(labels) != num:\n            raise ValueError(f\"Expected {num} labels, but got {len(labels)}\")\n    return labels", "code_hash": "db849c47168d4068e3bb651a6b83ef9d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "RGSE", "name": "_"}, {"code": "# We can now load the labels from both the datasets.\n\ntrain_labels = load_mnist_labels(DATASET_LOCATION + \"train-labels-idx1-ubyte\")\ntest_labels = load_mnist_labels(DATASET_LOCATION + \"t10k-labels-idx1-ubyte\")\n\nprint(len(train_labels), len(test_labels))\nprint(train_labels[0], test_labels[0])", "code_hash": "c9ebe2c39a2a05f6d7228f2b81863a07", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Kclp", "name": "_"}, {"code": "mo.md(r\"\"\"\nFor the images we can do the same thing, not the header is a little different.\n\"\"\")", "code_hash": "b178199a56155c28acf7cca19d2be79e", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "emfo", "name": "_"}, {"code": "def load_mnist_images(filename: str) -\u003E np.ndarray:\n    with open(filename, \"rb\") as f:\n        magic, num, rows, cols = struct.unpack(\"\u003EIIII\", f.read(16))\n        images = np.fromfile(f, dtype=np.uint8).reshape(num, rows, cols)\n        if len(images) != num:\n            raise ValueError(f\"Expected {num} images, but got {len(images)}\")\n    return images\n\n# We can now load the images from both the datasets.\ntrain_images = load_mnist_images(DATASET_LOCATION + \"train-images-idx3-ubyte\")\ntest_images = load_mnist_images(DATASET_LOCATION + \"t10k-images-idx3-ubyte\")", "code_hash": "44fea48841db10da3d3bc85799ffb011", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hstk", "name": "_"}, {"code": "mo.md(r\"\"\"\nFinally we can display the images using the matplotlib library.\n\"\"\")", "code_hash": "c92cec23d594032a20334c84cb52fc2e", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "nWHF", "name": "_"}, {"code": "def display_image(image: np.array, label: str) -\u003E None:\n    plt.title(f\"Label : {label}\")\n    plt.imshow(image, cmap=\"gray\")\n    plt.show()\n\n# We can now display the first image from the training dataset.\n\ndisplay_image(train_images[0], train_labels[0])\ndisplay_image(test_images[0], test_labels[0])", "code_hash": "8330ebf15be5c3668d1208ebf8efa77e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "iLit", "name": "_"}, {"code": "mo.md(r\"\"\"\n# Conclusions\n\nWe will use this data again in another example when we actually train a model with it. As mentioned in the introduction the MNIST dataset can also be downloaded using the torchvision library in PyTorch.\n\n```python\nimport torch\nfrom torchvision import datasets\nfrom torchvision.transforms import ToTensor\n\n# Download training data from open datasets.\ntraining_data = datasets.MNIST(\n    root=\"data\",\n    train=True,\n    download=True,\n    transform=ToTensor(),\n)\n```\n\nThis will also convert the data to a tensor which is the format we need to use it in PyTorch.\n\"\"\")", "code_hash": "b221a91cfde58d4945cf8b7fa59875fa", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ZHCJ", "name": "_"}, {"code": "import marimo as mo", "code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ROlb", "name": "_"}], "metadata": {"marimo_version": "0.17.7"}, "version": "1"},
            "session": {"cells": [{"code_hash": "8ab09d37d87315f0d690e7bf1064ab2c", "console": [], "id": "Hbol", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"the-mnist-dataset\"\u003EThe MNIST Dataset\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EThe MNIST dataset (Modified National Institute of Standards and Technology) is one of the most popular datasets used in machine learning and computer vision. It consists of a large collection of grey scale images of handwritten digits (0\u20139), which is widely used for training and testing in image processing and classification tasks.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EThe dataset contains 60,000 training images and 10,000 testing images. Each image is a 28x28 pixel square (784 pixels in total) with pixel values ranging from 0 to 255. The dataset is divided into 10 classes, one for each digit.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EIt is so common that most machine learning libraries provide a built-in function to download and load the dataset. For example the torchvision library in PyTorch provides a built-in function to download and load the MNIST dataset.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EHowever in this notebook we are going to download and process the images from source as this will provide a deeper understating of data sets in general and how they are processed in machine learning.\u003C/span\u003E\n\u003Ch2 id=\"setup\"\u003ESetup\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003ETo start with we are going to import the libraries we need including our Utils library which contains some helper functions to download datasets. We will also see if we are in the lab and if so we will download the data to the local file system (/transfer). If we are not in the lab we will download the data to the current working directory.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "5d1e5f930a499d5a810ecd97f1a6a884", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "mlutils.in_lab()=False\n", "type": "stream"}], "id": "MJUe", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "da72b7275893815aa3272aef93b05b8c", "console": [], "id": "vblA", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EWe will define a download location for the data, then use the download function to download it all. The data is split into training and testing data so we will download both. In this case as the data is self contained in a single file we will download it all into a single folder. If we we were downloading a dataset that was split into multiple files we would download each file into a separate folder.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "5b3d56a779c9c8f1004bbbf48697f856", "console": [], "id": "bkHC", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "8932e609d1aa3ab5fa3c0ac7636ae6d5", "console": [], "id": "lEQa", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EWe can use the \u003Ca href=\"https://docs.python.org/3/library/pathlib.html\" rel=\"noopener\" target=\"_blank\"\u003Epathlib\u003C/a\u003E module to do most of the work we need for file processing. In the case above we will create a new folder in the location we defined. If the folder already exists we will ignore it.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003ENext we are going to download the data, however we only really want to download it if it is not already present. We can use the pathlib module to check if the file exists and only download it if it does not. The files we are looking for are :\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003E- train-images-idx3-ubyte.gz:  training set images\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003E- train-labels-idx1-ubyte.gz:  training set labels\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003E- t10k-images-idx3-ubyte.gz:   test set images\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003E- t10k-labels-idx1-ubyte.gz:   test set labels\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EWe will download them from the google mirror outlined here \u003Ca href=\"https://github.com/cvdfoundation/mnist\" rel=\"noopener\" target=\"_blank\"\u003Ehttps://github.com/cvdfoundation/mnist\u003C/a\u003E\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "70976f73b4905b2ef612fb72a46a52d4", "console": [], "id": "PKri", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "ca29cc1c6022a80cb796e218f26c3062", "console": [], "id": "Xref", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThe downloaded files are compressed using gzip we need to uncompress them before we can use them. We can use the gzip module to do this.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "2b88bb20b2081a51df7e4ecfde2ff4c8", "console": [], "id": "SFPL", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "a0473a00f065c4fd9d05b701fea1beeb", "console": [], "id": "BYtC", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"data-format\"\u003EData Format\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003ENow we have downloaded the data we need to understand the format of the data. The data is stored in a binary format which is not human readable. The data is stored in a format called IDX which is a simple format for vectors and multidimensional matrices of various numerical types. The IDX file format is a simple format for vectors and multidimensional matrices of various numerical types. The basic format is\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003Emagic number\n    size in dimension 0\n    size in dimension 1\n    size in dimension 2\n    .....\n    size in dimension N\n    data\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EIn particular the MNIST is formatted as follows :\u003C/span\u003E\n\u003Cdiv class=\"language-tsql codehilite\"\u003E\u003Cpre\u003E\u003Cspan\u003E\u003C/span\u003E\u003Ccode\u003E\u003Cspan class=\"n\"\u003ELabels\u003C/span\u003E\n\u003Cspan class=\"o\"\u003E[\u003C/span\u003E\u003Cspan class=\"n\"\u003Eoffset\u003C/span\u003E\u003Cspan class=\"o\"\u003E]\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"o\"\u003E[\u003C/span\u003E\u003Cspan class=\"n\"\u003Etype\u003C/span\u003E\u003Cspan class=\"o\"\u003E]\u003C/span\u003E\u003Cspan class=\"w\"\u003E          \u003C/span\u003E\u003Cspan class=\"o\"\u003E[\u003C/span\u003E\u003Cspan class=\"n\"\u003Evalue\u003C/span\u003E\u003Cspan class=\"o\"\u003E]\u003C/span\u003E\u003Cspan class=\"w\"\u003E          \u003C/span\u003E\u003Cspan class=\"o\"\u003E[\u003C/span\u003E\u003Cspan class=\"n\"\u003Edescription\u003C/span\u003E\u003Cspan class=\"o\"\u003E]\u003C/span\u003E\n\u003Cspan class=\"mi\"\u003E0000\u003C/span\u003E\u003Cspan class=\"w\"\u003E     \u003C/span\u003E\u003Cspan class=\"mi\"\u003E32\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"nc\"\u003Ebit\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"k\"\u003Einteger\u003C/span\u003E\u003Cspan class=\"w\"\u003E  \u003C/span\u003E\u003Cspan class=\"mh\"\u003E0x00000801\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"mi\"\u003E2049\u003C/span\u003E\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"n\"\u003Emagic\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"n\"\u003Enumber\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003EMSB\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"k\"\u003Efirst\u003C/span\u003E\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\n\u003Cspan class=\"mi\"\u003E0004\u003C/span\u003E\u003Cspan class=\"w\"\u003E     \u003C/span\u003E\u003Cspan class=\"mi\"\u003E32\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"nc\"\u003Ebit\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"k\"\u003Einteger\u003C/span\u003E\u003Cspan class=\"w\"\u003E  \u003C/span\u003E\u003Cspan class=\"mi\"\u003E60000\u003C/span\u003E\u003Cspan class=\"w\"\u003E            \u003C/span\u003E\u003Cspan class=\"n\"\u003Enumber\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"k\"\u003Eof\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"n\"\u003Eitems\u003C/span\u003E\n\u003Cspan class=\"mi\"\u003E0008\u003C/span\u003E\u003Cspan class=\"w\"\u003E     \u003C/span\u003E\u003Cspan class=\"n\"\u003Eunsigned\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"n\"\u003Ebyte\u003C/span\u003E\u003Cspan class=\"w\"\u003E   \u003C/span\u003E\u003Cspan class=\"vm\"\u003E??\u003C/span\u003E\u003Cspan class=\"w\"\u003E               \u003C/span\u003E\u003Cspan class=\"n\"\u003Elabel\u003C/span\u003E\n\u003Cspan class=\"mi\"\u003E0009\u003C/span\u003E\u003Cspan class=\"w\"\u003E     \u003C/span\u003E\u003Cspan class=\"n\"\u003Eunsigned\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"n\"\u003Ebyte\u003C/span\u003E\u003Cspan class=\"w\"\u003E   \u003C/span\u003E\u003Cspan class=\"vm\"\u003E??\u003C/span\u003E\u003Cspan class=\"w\"\u003E               \u003C/span\u003E\u003Cspan class=\"n\"\u003Elabel\u003C/span\u003E\n\u003Cspan class=\"p\"\u003E........\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Exxxx\u003C/span\u003E\u003Cspan class=\"w\"\u003E     \u003C/span\u003E\u003Cspan class=\"n\"\u003Eunsigned\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"n\"\u003Ebyte\u003C/span\u003E\u003Cspan class=\"w\"\u003E   \u003C/span\u003E\u003Cspan class=\"vm\"\u003E??\u003C/span\u003E\u003Cspan class=\"w\"\u003E               \u003C/span\u003E\u003Cspan class=\"n\"\u003Elabel\u003C/span\u003E\n\n\u003Cspan class=\"n\"\u003EThe\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"n\"\u003Elabels\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"k\"\u003Evalues\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"k\"\u003Eare\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"mi\"\u003E0\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"k\"\u003Eto\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"mf\"\u003E9.\u003C/span\u003E\n\u003C/code\u003E\u003C/pre\u003E\u003C/div\u003E\n\u003Cspan class=\"paragraph\"\u003EAnd for the images\u003C/span\u003E\n\u003Cdiv class=\"language-tsql codehilite\"\u003E\u003Cpre\u003E\u003Cspan\u003E\u003C/span\u003E\u003Ccode\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"nc\"\u003EIMAGE\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"k\"\u003EFILE\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"nf\"\u003EFORMAT\u003C/span\u003E\n\u003Cspan class=\"o\"\u003E[\u003C/span\u003E\u003Cspan class=\"n\"\u003Eoffset\u003C/span\u003E\u003Cspan class=\"o\"\u003E]\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"o\"\u003E[\u003C/span\u003E\u003Cspan class=\"n\"\u003Etype\u003C/span\u003E\u003Cspan class=\"o\"\u003E]\u003C/span\u003E\u003Cspan class=\"w\"\u003E          \u003C/span\u003E\u003Cspan class=\"o\"\u003E[\u003C/span\u003E\u003Cspan class=\"n\"\u003Evalue\u003C/span\u003E\u003Cspan class=\"o\"\u003E]\u003C/span\u003E\u003Cspan class=\"w\"\u003E          \u003C/span\u003E\u003Cspan class=\"o\"\u003E[\u003C/span\u003E\u003Cspan class=\"n\"\u003Edescription\u003C/span\u003E\u003Cspan class=\"o\"\u003E]\u003C/span\u003E\n\u003Cspan class=\"mi\"\u003E0000\u003C/span\u003E\u003Cspan class=\"w\"\u003E     \u003C/span\u003E\u003Cspan class=\"mi\"\u003E32\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"nc\"\u003Ebit\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"k\"\u003Einteger\u003C/span\u003E\u003Cspan class=\"w\"\u003E  \u003C/span\u003E\u003Cspan class=\"mh\"\u003E0x00000803\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"mi\"\u003E2051\u003C/span\u003E\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"n\"\u003Emagic\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"n\"\u003Enumber\u003C/span\u003E\n\u003Cspan class=\"mi\"\u003E0004\u003C/span\u003E\u003Cspan class=\"w\"\u003E     \u003C/span\u003E\u003Cspan class=\"mi\"\u003E32\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"nc\"\u003Ebit\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"k\"\u003Einteger\u003C/span\u003E\u003Cspan class=\"w\"\u003E  \u003C/span\u003E\u003Cspan class=\"mi\"\u003E60000\u003C/span\u003E\u003Cspan class=\"w\"\u003E            \u003C/span\u003E\u003Cspan class=\"n\"\u003Enumber\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"k\"\u003Eof\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"n\"\u003Eimages\u003C/span\u003E\n\u003Cspan class=\"mi\"\u003E0008\u003C/span\u003E\u003Cspan class=\"w\"\u003E     \u003C/span\u003E\u003Cspan class=\"mi\"\u003E32\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"nc\"\u003Ebit\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"k\"\u003Einteger\u003C/span\u003E\u003Cspan class=\"w\"\u003E  \u003C/span\u003E\u003Cspan class=\"mi\"\u003E28\u003C/span\u003E\u003Cspan class=\"w\"\u003E               \u003C/span\u003E\u003Cspan class=\"n\"\u003Enumber\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"k\"\u003Eof\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"k\"\u003Erows\u003C/span\u003E\n\u003Cspan class=\"mi\"\u003E0012\u003C/span\u003E\u003Cspan class=\"w\"\u003E     \u003C/span\u003E\u003Cspan class=\"mi\"\u003E32\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"nc\"\u003Ebit\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"k\"\u003Einteger\u003C/span\u003E\u003Cspan class=\"w\"\u003E  \u003C/span\u003E\u003Cspan class=\"mi\"\u003E28\u003C/span\u003E\u003Cspan class=\"w\"\u003E               \u003C/span\u003E\u003Cspan class=\"n\"\u003Enumber\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"k\"\u003Eof\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"n\"\u003Ecolumns\u003C/span\u003E\n\u003Cspan class=\"mi\"\u003E0016\u003C/span\u003E\u003Cspan class=\"w\"\u003E     \u003C/span\u003E\u003Cspan class=\"n\"\u003Eunsigned\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"n\"\u003Ebyte\u003C/span\u003E\u003Cspan class=\"w\"\u003E   \u003C/span\u003E\u003Cspan class=\"vm\"\u003E??\u003C/span\u003E\u003Cspan class=\"w\"\u003E               \u003C/span\u003E\u003Cspan class=\"n\"\u003Epixel\u003C/span\u003E\n\u003Cspan class=\"mi\"\u003E0017\u003C/span\u003E\u003Cspan class=\"w\"\u003E     \u003C/span\u003E\u003Cspan class=\"n\"\u003Eunsigned\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"n\"\u003Ebyte\u003C/span\u003E\u003Cspan class=\"w\"\u003E   \u003C/span\u003E\u003Cspan class=\"vm\"\u003E??\u003C/span\u003E\u003Cspan class=\"w\"\u003E               \u003C/span\u003E\u003Cspan class=\"n\"\u003Epixel\u003C/span\u003E\n\u003Cspan class=\"p\"\u003E........\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Exxxx\u003C/span\u003E\u003Cspan class=\"w\"\u003E     \u003C/span\u003E\u003Cspan class=\"n\"\u003Eunsigned\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"n\"\u003Ebyte\u003C/span\u003E\u003Cspan class=\"w\"\u003E   \u003C/span\u003E\u003Cspan class=\"vm\"\u003E??\u003C/span\u003E\u003Cspan class=\"w\"\u003E               \u003C/span\u003E\u003Cspan class=\"n\"\u003Epixel\u003C/span\u003E\n\n\u003Cspan class=\"n\"\u003EPixels\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"k\"\u003Eare\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"n\"\u003Eorganized\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"k\"\u003Erow\u003C/span\u003E\u003Cspan class=\"o\"\u003E-\u003C/span\u003E\u003Cspan class=\"n\"\u003Ewise\u003C/span\u003E\u003Cspan class=\"p\"\u003E.\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"n\"\u003EPixel\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"k\"\u003Evalues\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"k\"\u003Eare\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"mi\"\u003E0\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"k\"\u003Eto\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"mf\"\u003E255.\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"mi\"\u003E0\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"n\"\u003Emeans\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"n\"\u003Ebackground\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Ewhite\u003C/span\u003E\u003Cspan class=\"p\"\u003E),\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"mi\"\u003E255\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"n\"\u003Emeans\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"n\"\u003Eforeground\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Eblack\u003C/span\u003E\u003Cspan class=\"p\"\u003E).\u003C/span\u003E\n\u003C/code\u003E\u003C/pre\u003E\u003C/div\u003E\n\u003Cspan class=\"paragraph\"\u003EWe can write python functions to extract the data and convert it into numpy arrays, one for the image data and one for the labels. We can then use the matplotlib library to display the images.\u003C/span\u003E\n\u003Ch2 id=\"loading-labels\"\u003ELoading Labels\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EWe are going to use the python \u003Ccode\u003Estruct\u003C/code\u003E module to read the header data then skip the header and read the rest of the data. We can then convert the data into a numpy array.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003ENote there is minimal error checking in this code, it is assumed the data is in the correct format, however we should be able to check the size of the data and the number of labels to ensure they match.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "db849c47168d4068e3bb651a6b83ef9d", "console": [], "id": "RGSE", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "c9ebe2c39a2a05f6d7228f2b81863a07", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "60000 10000\n5 7\n", "type": "stream"}], "id": "Kclp", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "b178199a56155c28acf7cca19d2be79e", "console": [], "id": "emfo", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EFor the images we can do the same thing, not the header is a little different.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "44fea48841db10da3d3bc85799ffb011", "console": [], "id": "Hstk", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "c92cec23d594032a20334c84cb52fc2e", "console": [], "id": "nWHF", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EFinally we can display the images using the matplotlib library.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "8330ebf15be5c3668d1208ebf8efa77e", "console": [{"data": "data:image/png;base64,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KSnploEJAADvCjFjsSWAmGHYZjQcAKByMwPLwsLCAncUHADAmwggAIAKAggAoIIAAgCoIIAAACoIIACACgIIAKCCAAIAqCCAAAAqCCAAgAoCCACgggACAKgggAAAKgggAAABBADwDlpAAAAVBBAAQAUBBABQQQABAFQQQAAAFQQQAEAFAQQAUEEAAQBUEEAAABUEEABABQEEAFBBAAEAVBBAAAAVBBAAQAUBBABQQQABAFQQQAAAFQQQAEAFAQQAUEEAAQBUEEAAABUEEABABQEEAFBBAAEAVBBAAAAVBBAAQAUBBABQQQABAFQQQAAAFQQQAEAFAQQAUEEAAQBUEEAAABUEEABABQEEAFBBAAEAVBBAAAAV9+i8LBCYqlat6romPDxcAtX06dP9qqtVq5brmvbt27uuiYuLc13z8ssvu6558sknxR9Xr151XbNkyRLXNYsXLxYvogUEAFBBAAEAgiOAFi1aJCEhIT5Lhw4dyvplAACVXLmcA+rYsaN89NFH/3uRezjVBADwVS7JYAInKiqqPJ4aABAkyuUc0IkTJyQmJkZatWolTz31lGRmZt523fz8fMnNzfVZAADBr8wDqGfPnpKYmChJSUmyevVqycjIkL59+8qlS5dKXT8hIcEOYy1amjZtWtabBADwQgANHz5cfvjDH0psbKwMHTpUPvjgA8nOzpZ333231PXj4+MlJyeneDl16lRZbxIAIACV++iAevXqSbt27SQ9Pb3Ux0NDQ+0CAPCWcv8e0OXLl+XkyZMSHR1d3i8FAPByAM2ZM0fS0tLkiy++kD179sjo0aPt9Cb+ToUBAAhOZd4Fd/r0aRs2Fy9elAYNGkifPn1k37599t8AAJRbAG3atKmsnxIBqlmzZq5rqlev7rrmoYcecl1jPvj4e87SrbFjx/r1WsHGfPh0a+XKla5rTK+KW7cbhXsnn376qesa0wOE74a54AAAKgggAIAKAggAoIIAAgCoIIAAACoIIACACgIIAEAAAQC8gxYQAEAFAQQAUEEAAQBUEEAAABUhjuM4EkByc3PtpblRcbp27epXXUpKiusafreVQ2FhoeuaZ555xq/rhVWErKwsv+r++9//uq45fvy4X68VjMxVrsPCwm77OC0gAIAKAggAoIIAAgCoIIAAACoIIACACgIIAKCCAAIAqCCAAAAqCCAAgAoCCACgggACAKgggAAAKgggAICKe3ReFoEkMzPTr7qLFy+6rmE27P+3f/9+1/suOzvbdc3AgQNd1xjXrl1zXfOnP/3Jr9eCd9ECAgCoIIAAACoIIACACgIIAKCCAAIAqCCAAAAqCCAAgAoCCACgggACAKgggAAAKgggAIAKAggAoILJSCFff/21X3th7ty5rmsef/xx1zWffPKJ65qVK1dKRTl8+LDrmkceecR1TV5enuuajh07ij9mzJjhVx3gBi0gAIAKAggAoIIAAgCoIIAAACoIIACACgIIAKCCAAIAqCCAAAAqCCAAgAoCCACgggACAKgggAAAKkIcx3EkgOTm5kp4eLj2ZqCchIWFua65dOmS65q1a9eKPyZNmuS65ic/+Ynrmo0bN7quASqbnJycb/2bpwUEAFBBAAEAKkcA7d69W0aMGCExMTESEhIiW7du9Xnc9OgtWLBAoqOjpWbNmjJ48GA5ceJEWW4zAMCLAWQuitWlSxdZtWpVqY8vXbrUXgxszZo1sn//fqldu7YMHTpUrl69WhbbCwDw6hVRhw8fbpfSmNbPq6++Kr/85S9l5MiR9r7169dLo0aNbEtp/Pjxd7/FAICgUKbngDIyMuTs2bO2262IGdHWs2dP2bt3b6k1+fn5duRbyQUAEPzKNIBM+BimxVOSuV302M0SEhJsSBUtTZs2LctNAgAEKPVRcPHx8XaseNFy6tQp7U0CAFS2AIqKirI/z50753O/uV302M1CQ0PtF5VKLgCA4FemAdSyZUsbNMnJycX3mXM6ZjRcr169yvKlAABeGwV3+fJlSU9P9xl4cPjwYYmIiJBmzZrJzJkz5Te/+Y20bdvWBtL8+fPtd4ZGjRpV1tsOAPBSAB04cEAGDhxYfHv27Nn254QJEyQxMVHmzZtnvys0ZcoUyc7Olj59+khSUpLUqFGjbLccAFCpMRkpgtKyZcv8qiv6QOVGWlqa65qSX1X4rgoLC13XAJqYjBQAEJDUh2EDALyJAAIAqCCAAAAqCCAAgAoCCACgggACAKgggAAAKgggAIAKAggAoIIAAgCoIIAAACoIIACACmbDRlCqXbu2X3Xbt293XdO/f3/XNcOHD3dd89e//tV1DaCJ2bABAAGJLjgAgAoCCACgggACAKgggAAAKgggAIAKAggAoIIAAgCoIIAAACoIIACACgIIAKCCAAIAqGAyUqCE1q1bu94fhw4dcl2TnZ3tumbXrl2uaw4cOCD+WLVqlesax3H8ei0ELyYjBQAEJLrgAAAqCCAAgAoCCACgggACAKgggAAAKgggAIAKAggAoIIAAgCoIIAAACoIIACACgIIAKCCyUiBuzR69GjXNevWrXNdU7duXakoL7zwguua9evXu67JyspyXYPKg8lIAQABiS44AIAKAggAoIIAAgCoIIAAACoIIACACgIIAKCCAAIAqCCAAAAqCCAAgAoCCACgggACAKhgMlJAQadOnVzXrFixwnXNoEGDpKKsXbvWdc2LL77ouubLL790XQMdTEYKAAhIdMEBACpHAO3evVtGjBghMTExEhISIlu3bvV5fOLEifb+ksuwYcPKcpsBAF4MoLy8POnSpYusWrXqtuuYwDEXmipaNm7ceLfbCQAIMve4LRg+fLhdvk1oaKhERUXdzXYBAIJcuZwDSk1NlYYNG0r79u1l2rRpcvHixduum5+fL7m5uT4LACD4lXkAme43c2345ORkeemllyQtLc22mAoKCkpdPyEhQcLDw4uXpk2blvUmAQCCoQvuTsaPH1/8786dO0tsbKy0bt3atopK+05CfHy8zJ49u/i2aQERQgAQ/Mp9GHarVq0kMjJS0tPTb3u+KCwszGcBAAS/cg+g06dP23NA0dHR5f1SAIBg7oK7fPmyT2smIyNDDh8+LBEREXZZvHixjB071o6CO3nypMybN0/atGkjQ4cOLettBwB4KYAOHDggAwcOLL5ddP5mwoQJsnr1ajly5Ii8+eabkp2dbb+sOmTIEPn1r39tu9oAACjCZKRAJVGvXj3XNWbWEn+sW7fOdY2Z9cStlJQU1zWPPPKI6xroYDJSAEBAYjJSAIAKAggAoIIAAgCoIIAAACoIIACACgIIAKCCAAIAqCCAAAAqCCAAgAoCCACgggACAKgggAAAKpgNG8At8vPzXe+Ve+5xfXUXuXHjhusaf64tlpqa6roGd4/ZsAEAAYkuOACACgIIAKCCAAIAqCCAAAAqCCAAgAoCCACgggACAKgggAAAKgggAIAKAggAoIIAAgCocD97IIC7Fhsb67rmiSeecF3TvXt38Yc/E4v649ixY65rdu/eXS7bgopHCwgAoIIAAgCoIIAAACoIIACACgIIAKCCAAIAqCCAAAAqCCAAgAoCCACgggACAKgggAAAKgggAIAKJiMFSmjfvr3r/TF9+nTXNWPGjHFdExUVJYGsoKDAdU1WVpbrmsLCQtc1CEy0gAAAKgggAIAKAggAoIIAAgCoIIAAACoIIACACgIIAKCCAAIAqCCAAAAqCCAAgAoCCACgggACAKhgMlIEPH8m4XzyySf9ei1/JhZt0aKFBJsDBw64rnnxxRdd17z//vuuaxA8aAEBAFQQQACAwA+ghIQE6d69u9StW1caNmwoo0aNkuPHj/usc/XqVYmLi5P69etLnTp1ZOzYsXLu3Lmy3m4AgJcCKC0tzYbLvn37ZOfOnXL9+nUZMmSI5OXlFa8za9Ys2b59u2zevNmuf+bMGb8uvgUACG6uBiEkJSX53E5MTLQtoYMHD0q/fv0kJydH3njjDXn77bfl4YcftuusW7dO7rvvPhtaDz74YNluPQDAm+eATOAYERER9qcJItMqGjx4cPE6HTp0kGbNmsnevXtLfY78/HzJzc31WQAAwc/vADLXZZ85c6b07t1bOnXqZO87e/asVK9eXerVq+ezbqNGjexjtzuvFB4eXrw0bdrU300CAHghgMy5oKNHj8qmTZvuagPi4+NtS6poOXXq1F09HwAgiL+Iar6st2PHDtm9e7c0adLE5wuD165dk+zsbJ9WkBkFd7svE4aGhtoFAOAtrlpAjuPY8NmyZYukpKRIy5YtfR7v1q2bVKtWTZKTk4vvM8O0MzMzpVevXmW31QAAb7WATLebGeG2bds2+12govM65txNzZo17c9JkybJ7Nmz7cCEsLAwee6552z4MAIOAOB3AK1evdr+HDBggM/9Zqj1xIkT7b9feeUVqVKliv0CqhnhNnToUPnd737n5mUAAB4Q4ph+tQBihmGblhQCnxnd6Nb999/vuub11193XWOG/web/fv3u65ZtmyZX69lejn8GRkLlGQGlpmesNthLjgAgAoCCACgggACAKgggAAAKgggAIAKAggAoIIAAgCoIIAAACoIIACACgIIAKCCAAIAqCCAAAAqCCAAQOW5IioCl7kOk1tr167167W6du3quqZVq1YSbPbs2eO6Zvny5a5rPvzwQ9c133zzjesaoKLQAgIAqCCAAAAqCCAAgAoCCACgggACAKgggAAAKgggAIAKAggAoIIAAgCoIIAAACoIIACACgIIAKCCyUgrSM+ePV3XzJ0713VNjx49XNc0btxY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", "mimetype": "image/png", "name": "media", "type": "streamMedia"}, {"data": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAaAAAAGzCAYAAABpdMNsAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjcsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvTLEjVAAAAAlwSFlzAAAPYQAAD2EBqD+naQAAHPJJREFUeJzt3QtQVNcdx/E/GkF8gKIiEAHf0fpKYnxQHzHq+EhqxZhprM5UOw5Wg06U+gid+GxnaGxrHFOjnWkqcaom2vHR2AytTxwbNNXUOKRqhJKiVXyWRbCi0ds5p8OWVUy668J/2f1+Zu4su3vP3svlcn97zj333DDHcRwBAKCONajrBQIAQAABANRQAwIAqCCAAAAqCCAAgAoCCACgggACAKgggAAAKgggAIAKAgjwwRdffCFhYWHy85//3G/b7+DBg/YzzSMQCggghIzs7Gx7gD927JiEimnTptnf+WHTP//5T+1VRAh7THsFANSeH/zgBzJy5EiP18zwjzNnzpT27dvL448/zuaHGgIICGIpKSl2qu7w4cNy8+ZNmTJlitp6AQZNcEA1t2/fliVLlkjfvn0lOjpamjZtKkOGDJEDBw48dDu9+eabkpycLJGRkfLss89Kfn7+A/OcPn1aXnrpJYmJiZHGjRvLM888I7///e993vbm84qLi30qu3nzZtv8NnnyZJ+XD/gDAQRUU1ZWJr/+9a9l2LBh8sYbb8iyZcvkypUrMnr0aDlx4sQD22rjxo2yZs0aSU9Pl8zMTBs+w4cPl0uXLrnn+eyzz2TgwIFy6tQpee211+QXv/iFDbbU1FTZsWOHT9u/e/fu8r3vfc/rcnfu3JGtW7fKN7/5TdsEB2iiCQ6opmXLlraHW3h4uPu1tLQ06datm7z11lvyzjvveGyvgoICOXv2rPtcypgxY2TAgAE2vFatWmVfe/XVVyUpKUn+8pe/SEREhH3tlVdekcGDB8uiRYtkwoQJdfY3+OMf/yjXrl2j+Q0BgRoQUE3Dhg3d4XPv3j25fv26fPnll7bJ7JNPPnlgW5laTPUT+f3797cB9OGHH9rnpvz+/fvlO9/5jty4cUOuXr1qJxMCplZlwsuXnmimI4Ev3bVN81ujRo3s+gDaCCDgPu+++6707t3bnqtp1aqVtGnTRv7whz+Iy+V6YFt16dLlgde6du1qa1FVNSQTFosXL7afU31aunSpnefy5ct18jcoLy+XXbt22eAzvxegjSY4oJrf/va39toZU7NZsGCBxMbG2lpRVlaWFBYWer2tTC3KmD9/vj3w16Rz58518jfYuXMnvd8QUAggoJrf/e530rFjR9m+fbvtKValqrZyP9OEdr/PP//cfYLffJZhmr3uvx6nrm3atEmaNWsm3/72t1XXA6hCExxQjantGKbZrMrRo0clLy/vobWK6udwPv74Yzv/2LFj7XNTgzI96n71q1/JxYsXHyhvetjVRTdss5y9e/faDg9NmjTxaZmAv1EDQsj5zW9+Izk5OQ+8bnqrfetb37K1H3OgfuGFF6SoqEjWr18v3/jGN+w5lJqaz0xvtlmzZkllZaWsXr3anl9ZuHChe561a9faeXr16mV71JlakemmbULt/Pnz8umnn/rUDdtcc/T/dkR4//33bWcKLj5FICGAEHLWrVtX4+vm3I+ZSkpKbI3FdFk2wWPOC23btq3Gg725FqdBgwY2eExnAtML7pe//KXEx8e75zGfYcafW758uR2PzvSAMzWjp556yl70WlfNb2aZ2s2AQHVhTvW2BgAA6gjngAAAKgggAIAKAggAoIIAAgCoIIAAACoIIACAioC7DsiMnXXhwgVp3ry5x1AoAID6wVzdY0Z/T0hIsNfJ1ZsAMuGTmJiovRoAgEd07tw5adeuXf1pgjM1HwBA/fd1x/NaCyAz/pUZEdjcU8XcoMsM0vj/oNkNAILD1x3PayWAzMCHGRkZdgh7cxfJPn362Huh1NWNtwAA9YBTC/r37++kp6e7n9+9e9dJSEhwsrKyvrasy+UyY9MxsQ3YB9gH2Aekfm8Dczz/Kn6vAd2+fVuOHz/uMequ6QVhntd0TxUzhH1ZWZnHBAAIfn4PoKtXr8rdu3elbdu2Hq+b52aY+/uZWx1HR0e7J3rAAUBoUO8Fl5mZKS6Xyz2ZbnsAgODn9+uAWrdubW9rbO74WJ15HhcX98D8ERERdgIAhBa/14DCw8Olb9++sm/fPo/RDczzlJQUfy8OAFBP1cpICKYL9tSpU+WZZ56xtyg2tyuuqKiQ73//+7WxOABAPVQrAfTyyy/LlStX7P3uTceDJ598UnJych7omAAACF1hpi+2BBDTDdv0hgMA1G+mY1lUVFTg9oIDAIQmAggAoIIAAgCoIIAAACoIIACACgIIAKCCAAIAqCCAAAAqCCAAgAoCCACgggACAKgggAAAKgggAIAKAggAQAABAEIHNSAAgAoCCACgggACAKgggAAAKgggAIAKAggAoIIAAgCoIIAAACoIIACACgIIAKCCAAIAqCCAAAAqCCAAgAoCCACgggACAKgggAAAKgggAIAKAggAoIIAAgCoIIAAACoIIACACgIIAKCCAAIAqCCAAAAqCCAAgAoCCACgggACAKgggAAAKgggAIAKAggAoIIAAgCoIIAAACoIIACACgIIAKCCAAIAqCCAAAAqCCAAgAoCCACgggACAKgggAAAwRFAy5Ytk7CwMI+pW7du/l4MAKCee6w2PrRHjx6yd+/e/y3ksVpZDACgHquVZDCBExcXVxsfDQAIErVyDujs2bOSkJAgHTt2lClTpkhxcfFD562srJSysjKPCQAQ/PweQAMGDJDs7GzJycmRdevWSVFRkQwZMkRu3LhR4/xZWVkSHR3tnhITE/29SgCAABTmOI5TmwsoLS2V5ORkWbVqlUyfPr3GGpCZqpgaECEEAPWfy+WSqKioh75f670DWrRoIV27dpWCgoIa34+IiLATACC01Pp1QOXl5VJYWCjx8fG1vSgAQCgH0Pz58yU3N1e++OIL+eijj2TChAnSsGFD+e53v+vvRQEA6jG/N8GdP3/ehs21a9ekTZs2MnjwYDly5Ij9GQCAOuuE4C3TCcH0hgMABHcnBMaCAwCoIIAAACoIIACACgIIAKCCAAIAqCCAAAAqCCAAAAEEAAgd1IAAACoIIACACgIIAKCCAAIAqKj1G9Khbr300ktel0lLS/NpWRcuXPC6zK1bt7wus2nTJq/LlJSUiC8eduNEAP5HDQgAoIIAAgCoIIAAACoIIACACgIIAKCCAAIAqCCAAAAqCCAAgAoCCACgggACAKgggAAAKgggAIAKAggAoCLMcRxHAkhZWZlER0drr0a99fe//93rMu3bt5dgc+PGDZ/KffbZZ35fF/jX+fPnvS6zcuVKn5Z17Ngxn8rhv1wul0RFRcnDUAMCAKgggAAAKgggAIAKAggAoIIAAgCoIIAAACoIIACACgIIAKCCAAIAqCCAAAAqCCAAgAoCCACg4jGdxaK2pKWleV2md+/ePi3r1KlTXpfp3r2712Wefvppr8sMGzZMfDFw4ECvy5w7d87rMomJiRLIvvzyS6/LXLlyxesy8fHxUheKi4t9KsdgpLWLGhAAQAUBBABQQQABAFQQQAAAFQQQAEAFAQQAUEEAAQBUEEAAABUEEABABQEEAFBBAAEAVBBAAAAVDEYaZPbt21cnZXyVk5NTJ8tp2bKlT+WefPJJr8scP37c6zL9+vWTQHbr1i2vy3z++ed1MqBtTEyM12UKCwu9LoPaRw0IAKCCAAIA1I8AOnTokIwbN04SEhIkLCxMdu7c6fG+4ziyZMkSe5+PyMhIGTlypJw9e9af6wwACMUAqqiokD59+sjatWtrfH/lypWyZs0aWb9+vRw9elSaNm0qo0eP9qlNGQAQvLzuhDB27Fg71cTUflavXi2vv/66jB8/3r62ceNGadu2ra0pTZo06dHXGAAQFPx6DqioqEhKSkpss1uV6OhoGTBggOTl5dVYprKyUsrKyjwmAEDw82sAmfAxTI2nOvO86r37ZWVl2ZCqmhITE/25SgCAAKXeCy4zM1NcLpd7OnfunPYqAQDqWwDFxcXZx0uXLnm8bp5XvXe/iIgIiYqK8pgAAMHPrwHUoUMHGzTVr6w353RMb7iUlBR/LgoAEGq94MrLy6WgoMCj48GJEyfs8BhJSUkyd+5c+clPfiJdunSxgbR48WJ7zVBqaqq/1x0AEEoBdOzYMXnuuefczzMyMuzj1KlTJTs7WxYuXGivFZoxY4aUlpbK4MGD7fhfjRs39u+aAwDqtTDHXLwTQEyTnekNB6B+mThxotdltm7d6nWZ/Px8r8tU/9LsjevXr/tUDv9lOpZ91Xl99V5wAIDQRAABAFQQQAAAFQQQAEAFAQQAUEEAAQBUEEAAABUEEABABQEEAFBBAAEAVBBAAAAVBBAAQAUBBACoH7djABD8YmNjvS7z9ttve12mQQPvvwOvWLHC6zKMah2YqAEBAFQQQAAAFQQQAEAFAQQAUEEAAQBUEEAAABUEEABABQEEAFBBAAEAVBBAAAAVBBAAQAUBBABQwWCkAB6Qnp7u9VZp06aN12X+9a9/eV3mzJkzXpdBYKIGBABQQQABAFQQQAAAFQQQAEAFAQQAUEEAAQBUEEAAABUEEABABQEEAFBBAAEAVBBAAAAVBBAAQAWDkQJBbNCgQT6Ve+2116QupKamel0mPz+/VtYFdY8aEABABQEEAFBBAAEAVBBAAAAVBBAAQAUBBABQQQABAFQQQAAAFQQQAEAFAQQAUEEAAQBUEEAAABUMRgoEseeff96nco0aNfK6zL59+7wuk5eX53UZBA9qQAAAFQQQAKB+BNChQ4dk3LhxkpCQIGFhYbJz506P96dNm2Zfrz6NGTPGn+sMAAjFAKqoqJA+ffrI2rVrHzqPCZyLFy+6py1btjzqegIAQr0TwtixY+30VSIiIiQuLu5R1gsAEORq5RzQwYMHJTY2Vp544gmZNWuWXLt27aHzVlZWSllZmccEAAh+fg8g0/y2ceNG2yXzjTfekNzcXFtjunv3bo3zZ2VlSXR0tHtKTEz09yoBAELhOqBJkya5f+7Vq5f07t1bOnXqZGtFI0aMeGD+zMxMycjIcD83NSBCCACCX613w+7YsaO0bt1aCgoKHnq+KCoqymMCAAS/Wg+g8+fP23NA8fHxtb0oAEAwN8GVl5d71GaKiorkxIkTEhMTY6fly5fLxIkTbS+4wsJCWbhwoXTu3FlGjx7t73UHAIRSAB07dkyee+459/Oq8zdTp06VdevWycmTJ+Xdd9+V0tJSe7HqqFGj5Mc//rFtagMAoEqY4ziOBBDTCcH0hgPgKTIy0utNcvjwYZ82Y48ePbwuM3z4cK/LfPTRR16XQf3hcrm+8rw+Y8EBAFQQQAAAFQQQAEAFAQQAUEEAAQBUEEAAABUEEABABQEEAFBBAAEAVBBAAAAVBBAAQAUBBABQQQABAILjltwAaseCBQu8LvPUU0/5tKycnByvyzCyNbxFDQgAoIIAAgCoIIAAACoIIACACgIIAKCCAAIAqCCAAAAqCCAAgAoCCACgggACAKgggAAAKgggAIAKBiMFFLzwwgtel1m8eLHXZcrKysQXK1as8Kkc4A1qQAAAFQQQAEAFAQQAUEEAAQBUEEAAABUEEABABQEEAFBBAAEAVBBAAAAVBBAAQAUBBABQQQABAFQwGCnwiFq1auV1mTVr1nhdpmHDhl6X+fDDD8UXR44c8akc4A1qQAAAFQQQAEAFAQQAUEEAAQBUEEAAABUEEABABQEEAFBBAAEAVBBAAAAVBBAAQAUBBABQQQABAFQwGCnwiAN+5uTkeF2mQ4cOXpcpLCz0uszixYu9LgPUFWpAAAAVBBAAIPADKCsrS/r16yfNmzeX2NhYSU1NlTNnznjMc+vWLUlPT7f3SGnWrJlMnDhRLl265O/1BgCEUgDl5ubacDE3q9qzZ4/cuXNHRo0aJRUVFe555s2bJx988IFs27bNzn/hwgV58cUXa2PdAQCh0gnh/pOt2dnZtiZ0/PhxGTp0qLhcLnnnnXdk8+bNMnz4cDvPhg0bpHv37ja0Bg4c6N+1BwCE5jkgEzhGTEyMfTRBZGpFI0eOdM/TrVs3SUpKkry8vBo/o7KyUsrKyjwmAEDw8zmA7t27J3PnzpVBgwZJz5497WslJSUSHh4uLVq08Ji3bdu29r2HnVeKjo52T4mJib6uEgAgFALInAvKz8+X995775FWIDMz09akqqZz58490ucBAIL4QtTZs2fL7t275dChQ9KuXTv363FxcXL79m0pLS31qAWZXnDmvZpERETYCQAQWryqATmOY8Nnx44dsn///geu5u7bt680atRI9u3b537NdNMuLi6WlJQU/601ACC0akCm2c30cNu1a5e9FqjqvI45dxMZGWkfp0+fLhkZGbZjQlRUlMyZM8eGDz3gAAA+B9C6devs47BhwzxeN12tp02bZn9+8803pUGDBvYCVNPDbfTo0fL22297sxgAQAgIc0y7WgAx3bBNTQrQ0LVrV6/LnD59WurC+PHjvS5jLgoHtJiOZaYl7GEYCw4AoIIAAgCoIIAAACoIIACACgIIAKCCAAIAqCCAAAAqCCAAgAoCCACgggACAKgggAAAKgggAIAKAggAUH/uiAoEuuTkZJ/K/elPf5K6sGDBAq/LmLsQA8GEGhAAQAUBBABQQQABAFQQQAAAFQQQAEAFAQQAUEEAAQBUEEAAABUEEABABQEEAFBBAAEAVBBAAAAVDEaKoDRjxgyfyiUlJUldyM3N9bqM4zi1si6AFmpAAAAVBBAAQAUBBABQQQABAFQQQAAAFQQQAEAFAQQAUEEAAQBUEEAAABUEEABABQEEAFBBAAEAVDAYKQLe4MGDvS4zZ86cWlkXAP5DDQgAoIIAAgCoIIAAACoIIACACgIIAKCCAAIAqCCAAAAqCCAAgAoCCACgggACAKgggAAAKgggAIAKBiNFwBsyZIjXZZo1ayZ1pbCw0Osy5eXltbIuQH1CDQgAoIIAAgAEfgBlZWVJv379pHnz5hIbGyupqaly5swZj3mGDRsmYWFhHtPMmTP9vd4AgFAKoNzcXElPT5cjR47Inj175M6dOzJq1CipqKjwmC8tLU0uXrzonlauXOnv9QYAhFInhJycHI/n2dnZtiZ0/PhxGTp0qPv1Jk2aSFxcnP/WEgAQdB7pHJDL5bKPMTExHq9v2rRJWrduLT179pTMzEy5efPmQz+jsrJSysrKPCYAQPDzuRv2vXv3ZO7cuTJo0CAbNFUmT54sycnJkpCQICdPnpRFixbZ80Tbt29/6Hml5cuX+7oaAIBQCyBzLig/P18OHz7s8fqMGTPcP/fq1Uvi4+NlxIgR9lqJTp06PfA5poaUkZHhfm5qQImJib6uFgAgmANo9uzZsnv3bjl06JC0a9fuK+cdMGCAfSwoKKgxgCIiIuwEAAgtXgWQ4zgyZ84c2bFjhxw8eFA6dOjwtWVOnDhhH01NCAAAnwLINLtt3rxZdu3aZa8FKikpsa9HR0dLZGSkbWYz7z///PPSqlUrew5o3rx5todc7969vVkUACDIeRVA69atc19sWt2GDRtk2rRpEh4eLnv37pXVq1fba4PMuZyJEyfK66+/7t+1BgCEXhPcVzGBYy5WBQDg6zAaNlDNp59+6vX2ML08vXX9+nW2O0Ieg5ECAFQQQAAAFQQQAEAFAQQAUEEAAQBUEEAAABUEEABABQEEAFBBAAEAVBBAAAAVBBAAQAUBBABQEeZ83RDXdczcktvcXwgAUL+5XC6Jiop66PvUgAAAKgggAIAKAggAoIIAAgCoIIAAACoIIACACgIIAKCCAAIAqCCAAAAqCCAAgAoCCACgIuACKMCGpgMA1NLxPOAC6MaNG9qrAACog+N5wI2Gfe/ePblw4YI0b95cwsLCHhgpOzExUc6dO/eVI6wGO7YD24H9gf+LQD4+mFgx4ZOQkCANGjy8nvOYBBizsu3atfvKecxGDeUAqsJ2YDuwP/B/EajHh//ntjoB1wQHAAgNBBAAQEW9CqCIiAhZunSpfQxlbAe2A/sD/xfBcHwIuE4IAIDQUK9qQACA4EEAAQBUEEAAABUEEABABQEEAFBRbwJo7dq10r59e2ncuLEMGDBAPv74Y+1VqnPLli2zwxNVn7p16ybB7tChQzJu3Dg7rIf5nXfu3OnxvunIuWTJEomPj5fIyEgZOXKknD17VkJtO0ybNu2B/WPMmDESTLKysqRfv352qK7Y2FhJTU2VM2fOeMxz69YtSU9Pl1atWkmzZs1k4sSJcunSJQm17TBs2LAH9oeZM2dKIKkXAfT+++9LRkaG7dv+ySefSJ8+fWT06NFy+fJlCTU9evSQixcvuqfDhw9LsKuoqLB/c/MlpCYrV66UNWvWyPr16+Xo0aPStGlTu3+YA1EobQfDBE71/WPLli0STHJzc224HDlyRPbs2SN37tyRUaNG2W1TZd68efLBBx/Itm3b7PxmbMkXX3xRQm07GGlpaR77g/lfCShOPdC/f38nPT3d/fzu3btOQkKCk5WV5YSSpUuXOn369HFCmdlld+zY4X5+7949Jy4uzvnZz37mfq20tNSJiIhwtmzZ4oTKdjCmTp3qjB8/3gklly9fttsiNzfX/bdv1KiRs23bNvc8p06dsvPk5eU5obIdjGeffdZ59dVXnUAW8DWg27dvy/Hjx22zSvUBS83zvLw8CTWmack0wXTs2FGmTJkixcXFEsqKioqkpKTEY/8wgyCaZtpQ3D8OHjxom2SeeOIJmTVrlly7dk2Cmcvlso8xMTH20RwrTG2g+v5gmqmTkpKCen9w3bcdqmzatElat24tPXv2lMzMTLl586YEkoAbDft+V69elbt370rbtm09XjfPT58+LaHEHFSzs7PtwcVUp5cvXy5DhgyR/Px82xYcikz4GDXtH1XvhQrT/Gaamjp06CCFhYXyox/9SMaOHWsPvA0bNpRgY27dMnfuXBk0aJA9wBrmbx4eHi4tWrQImf3hXg3bwZg8ebIkJyfbL6wnT56URYsW2fNE27dvl0AR8AGE/zEHkyq9e/e2gWR2sK1bt8r06dPZVCFu0qRJ7p979epl95FOnTrZWtGIESMk2JhzIObLVyicB/VlO8yYMcNjfzCddMx+YL6cmP0iEAR8E5ypPppvb/f3YjHP4+LiJJSZb3ldu3aVgoICCVVV+wD7x4NMM635/wnG/WP27Nmye/duOXDggMf9w8z+YJrtS0tLQ+J4Mfsh26Em5gurEUj7Q8AHkKlO9+3bV/bt2+dR5TTPU1JSJJSVl5fbbzPmm02oMs1N5sBSff8wd4Q0veFCff84f/68PQcUTPuH6X9hDro7duyQ/fv3279/deZY0ahRI4/9wTQ7mXOlwbQ/OF+zHWpy4sQJ+xhQ+4NTD7z33nu2V1N2drbzt7/9zZkxY4bTokULp6SkxAklP/zhD52DBw86RUVFzp///Gdn5MiRTuvWrW0PmGB248YN569//audzC67atUq+/M//vEP+/5Pf/pTuz/s2rXLOXnypO0J1qFDB+ff//63Eyrbwbw3f/5829PL7B979+51nn76aadLly7OrVu3nGAxa9YsJzo62v4fXLx40T3dvHnTPc/MmTOdpKQkZ//+/c6xY8eclJQUOwWTWV+zHQoKCpwVK1bY39/sD+Z/o2PHjs7QoUOdQFIvAsh466237E4VHh5uu2UfOXLECTUvv/yyEx8fb7fB448/bp+bHS3YHThwwB5w759Mt+OqrtiLFy922rZta7+ojBgxwjlz5owTStvBHHhGjRrltGnTxnZDTk5OdtLS0oLuS1pNv7+ZNmzY4J7HfPF45ZVXnJYtWzpNmjRxJkyYYA/OobQdiouLbdjExMTY/4nOnTs7CxYscFwulxNIuB8QAEBFwJ8DAgAEJwIIAKCCAAIAqCCAAAAqCCAAgAoCCACgggACAKgggAAAKgggAAABBAAIHdSAAACi4T/iwQcsXjPF5gAAAABJRU5ErkJggg==", "mimetype": "image/png", "name": "media", "type": "streamMedia"}], "id": "iLit", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "b221a91cfde58d4945cf8b7fa59875fa", "console": [], "id": "ZHCJ", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"conclusions\"\u003EConclusions\u003C/h1\u003E\n\u003Cspan class=\"paragraph\"\u003EWe will use this data again in another example when we actually train a model with it. As mentioned in the introduction the MNIST dataset can also be downloaded using the torchvision library in PyTorch.\u003C/span\u003E\n\u003Cdiv class=\"language-python codehilite\"\u003E\u003Cpre\u003E\u003Cspan\u003E\u003C/span\u003E\u003Ccode\u003E\u003Cspan class=\"kn\"\u003Eimport\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"nn\"\u003Etorch\u003C/span\u003E\n\u003Cspan class=\"kn\"\u003Efrom\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"nn\"\u003Etorchvision\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"kn\"\u003Eimport\u003C/span\u003E \u003Cspan class=\"n\"\u003Edatasets\u003C/span\u003E\n\u003Cspan class=\"kn\"\u003Efrom\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"nn\"\u003Etorchvision.transforms\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"kn\"\u003Eimport\u003C/span\u003E \u003Cspan class=\"n\"\u003EToTensor\u003C/span\u003E\n\n\u003Cspan class=\"c1\"\u003E# Download training data from open datasets.\u003C/span\u003E\n\u003Cspan class=\"n\"\u003Etraining_data\u003C/span\u003E \u003Cspan class=\"o\"\u003E=\u003C/span\u003E \u003Cspan class=\"n\"\u003Edatasets\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003EMNIST\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\n    \u003Cspan class=\"n\"\u003Eroot\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"s2\"\u003E\u0026quot;data\u0026quot;\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E\n    \u003Cspan class=\"n\"\u003Etrain\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"kc\"\u003ETrue\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E\n    \u003Cspan class=\"n\"\u003Edownload\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"kc\"\u003ETrue\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E\n    \u003Cspan class=\"n\"\u003Etransform\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"n\"\u003EToTensor\u003C/span\u003E\u003Cspan class=\"p\"\u003E(),\u003C/span\u003E\n\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\n\u003C/code\u003E\u003C/pre\u003E\u003C/div\u003E\n\u003Cspan class=\"paragraph\"\u003EThis will also convert the data to a tensor which is the format we need to use it in PyTorch.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e", "console": [], "id": "ROlb", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}], "metadata": {"marimo_version": "0.17.7"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.17.7%22%0Aapp%20%3D%20marimo.App(width%3D%22full%22)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20The%20MNIST%20Dataset%0A%0A%20%20%20%20The%20MNIST%20dataset%20(Modified%20National%20Institute%20of%20Standards%20and%20Technology)%20is%20one%20of%20the%20most%20popular%20datasets%20used%20in%20machine%20learning%20and%20computer%20vision.%20It%20consists%20of%20a%20large%20collection%20of%20grey%20scale%20images%20of%20handwritten%20digits%20(0%E2%80%939)%2C%20which%20is%20widely%20used%20for%20training%20and%20testing%20in%20image%20processing%20and%20classification%20tasks.%0A%0A%20%20%20%20The%20dataset%20contains%2060%2C000%20training%20images%20and%2010%2C000%20testing%20images.%20Each%20image%20is%20a%2028x28%20pixel%20square%20(784%20pixels%20in%20total)%20with%20pixel%20values%20ranging%20from%200%20to%20255.%20The%20dataset%20is%20divided%20into%2010%20classes%2C%20one%20for%20each%20digit.%0A%0A%20%20%20%20It%20is%20so%20common%20that%20most%20machine%20learning%20libraries%20provide%20a%20built-in%20function%20to%20download%20and%20load%20the%20dataset.%20For%20example%20the%20torchvision%20library%20in%20PyTorch%20provides%20a%20built-in%20function%20to%20download%20and%20load%20the%20MNIST%20dataset.%0A%0A%20%20%20%20However%20in%20this%20notebook%20we%20are%20going%20to%20download%20and%20process%20the%20images%20from%20source%20as%20this%20will%20provide%20a%20deeper%20understating%20of%20data%20sets%20in%20general%20and%20how%20they%20are%20processed%20in%20machine%20learning.%0A%0A%20%20%20%20%23%23%20Setup%0A%0A%20%20%20%20To%20start%20with%20we%20are%20going%20to%20import%20the%20libraries%20we%20need%20including%20our%20Utils%20library%20which%20contains%20some%20helper%20functions%20to%20download%20datasets.%20We%20will%20also%20see%20if%20we%20are%20in%20the%20lab%20and%20if%20so%20we%20will%20download%20the%20data%20to%20the%20local%20file%20system%20(%2Ftransfer).%20If%20we%20are%20not%20in%20the%20lab%20we%20will%20download%20the%20data%20to%20the%20current%20working%20directory.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20pathlib%0A%20%20%20%20import%20struct%0A%20%20%20%20import%20sys%0A%0A%20%20%20%20import%20matplotlib.pyplot%20as%20plt%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20import%20mlutils%0A%0A%20%20%20%20print(f%22%7Bmlutils.in_lab()%3D%7D%22)%0A%20%20%20%20return%20mlutils%2C%20np%2C%20pathlib%2C%20plt%2C%20struct%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20We%20will%20define%20a%20download%20location%20for%20the%20data%2C%20then%20use%20the%20download%20function%20to%20download%20it%20all.%20The%20data%20is%20split%20into%20training%20and%20testing%20data%20so%20we%20will%20download%20both.%20In%20this%20case%20as%20the%20data%20is%20self%20contained%20in%20a%20single%20file%20we%20will%20download%20it%20all%20into%20a%20single%20folder.%20If%20we%20we%20were%20downloading%20a%20dataset%20that%20was%20split%20into%20multiple%20files%20we%20would%20download%20each%20file%20into%20a%20separate%20folder.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mlutils%2C%20pathlib)%3A%0A%20%20%20%20DATASET_LOCATION%20%3D%20%22%22%0A%20%20%20%20if%20mlutils.in_lab()%3A%0A%20%20%20%20%20%20%20%20DATASET_LOCATION%20%3D%20%22%2Ftransfer%2FMNIST_Dataset%2F%22%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20DATASET_LOCATION%20%3D%20%22.%2FMNIST_Dataset%2F%22%0A%20%20%20%20%23%20now%20we%20will%20create%20the%20folder%20if%20it%20does%20not%20exist%0A%20%20%20%20pathlib.Path(DATASET_LOCATION).mkdir(parents%3DTrue%2C%20exist_ok%3DTrue)%0A%20%20%20%20return%20(DATASET_LOCATION%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20We%20can%20use%20the%20%5Bpathlib%5D(https%3A%2F%2Fdocs.python.org%2F3%2Flibrary%2Fpathlib.html)%20module%20to%20do%20most%20of%20the%20work%20we%20need%20for%20file%20processing.%20In%20the%20case%20above%20we%20will%20create%20a%20new%20folder%20in%20the%20location%20we%20defined.%20If%20the%20folder%20already%20exists%20we%20will%20ignore%20it.%0A%0A%20%20%20%20Next%20we%20are%20going%20to%20download%20the%20data%2C%20however%20we%20only%20really%20want%20to%20download%20it%20if%20it%20is%20not%20already%20present.%20We%20can%20use%20the%20pathlib%20module%20to%20check%20if%20the%20file%20exists%20and%20only%20download%20it%20if%20it%20does%20not.%20The%20files%20we%20are%20looking%20for%20are%20%3A%0A%0A%20%20%20%20%20%20%20%20-%20train-images-idx3-ubyte.gz%3A%20%20training%20set%20images%0A%20%20%20%20%20%20%20%20-%20train-labels-idx1-ubyte.gz%3A%20%20training%20set%20labels%0A%20%20%20%20%20%20%20%20-%20t10k-images-idx3-ubyte.gz%3A%20%20%20test%20set%20images%0A%20%20%20%20%20%20%20%20-%20t10k-labels-idx1-ubyte.gz%3A%20%20%20test%20set%20labels%0A%0A%20%20%20%20We%20will%20download%20them%20from%20the%20google%20mirror%20outlined%20here%20https%3A%2F%2Fgithub.com%2Fcvdfoundation%2Fmnist%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(DATASET_LOCATION%2C%20mlutils%2C%20pathlib)%3A%0A%20%20%20%20files%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%22train-images-idx3-ubyte.gz%22%2C%0A%20%20%20%20%20%20%20%20%22train-labels-idx1-ubyte.gz%22%2C%0A%20%20%20%20%20%20%20%20%22t10k-images-idx3-ubyte.gz%22%2C%0A%20%20%20%20%20%20%20%20%22t10k-labels-idx1-ubyte.gz%22%2C%0A%20%20%20%20%5D%0A%20%20%20%20URL%20%3D%20%22https%3A%2F%2Fstorage.googleapis.com%2Fcvdf-datasets%2Fmnist%2F%22%0A%20%20%20%20for%20_file%20in%20files%3A%0A%20%20%20%20%20%20%20%20if%20not%20pathlib.Path(DATASET_LOCATION%20%2B%20_file).exists()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22Downloading%20%7B_file%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20mlutils.download(f%22%7BURL%7D%7B_file%7D%22%2C%20DATASET_LOCATION%20%2B%20_file)%0A%20%20%20%20return%20(files%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20The%20downloaded%20files%20are%20compressed%20using%20gzip%20we%20need%20to%20uncompress%20them%20before%20we%20can%20use%20them.%20We%20can%20use%20the%20gzip%20module%20to%20do%20this.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(DATASET_LOCATION%2C%20files%2C%20pathlib)%3A%0A%20%20%20%20import%20gzip%0A%0A%20%20%20%20for%20_file%20in%20files%3A%0A%20%20%20%20%20%20%20%20if%20not%20pathlib.Path(DATASET_LOCATION%20%2B%20_file%5B%3A-3%5D).exists()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22Unzipping%20%7B_file%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20with%20gzip.open(DATASET_LOCATION%20%2B%20_file%2C%20%22rb%22)%20as%20f_in%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20with%20open(DATASET_LOCATION%20%2B%20_file%5B%3A-3%5D%2C%20%22wb%22)%20as%20f_out%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f_out.write(f_in.read())%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Data%20Format%0A%0A%20%20%20%20Now%20we%20have%20downloaded%20the%20data%20we%20need%20to%20understand%20the%20format%20of%20the%20data.%20The%20data%20is%20stored%20in%20a%20binary%20format%20which%20is%20not%20human%20readable.%20The%20data%20is%20stored%20in%20a%20format%20called%20IDX%20which%20is%20a%20simple%20format%20for%20vectors%20and%20multidimensional%20matrices%20of%20various%20numerical%20types.%20The%20IDX%20file%20format%20is%20a%20simple%20format%20for%20vectors%20and%20multidimensional%20matrices%20of%20various%20numerical%20types.%20The%20basic%20format%20is%0A%0A%20%20%20%20%20%20%20%20magic%20number%0A%20%20%20%20%20%20%20%20size%20in%20dimension%200%0A%20%20%20%20%20%20%20%20size%20in%20dimension%201%0A%20%20%20%20%20%20%20%20size%20in%20dimension%202%0A%20%20%20%20%20%20%20%20.....%0A%20%20%20%20%20%20%20%20size%20in%20dimension%20N%0A%20%20%20%20%20%20%20%20data%0A%0A%20%20%20%20In%20particular%20the%20MNIST%20is%20formatted%20as%20follows%20%3A%0A%0A%20%20%20%20%60%60%60%0A%20%20%20%20Labels%0A%20%20%20%20%5Boffset%5D%20%5Btype%5D%20%20%20%20%20%20%20%20%20%20%5Bvalue%5D%20%20%20%20%20%20%20%20%20%20%5Bdescription%5D%0A%20%20%20%200000%20%20%20%20%2032%20bit%20integer%20%200x00000801(2049)%20magic%20number%20(MSB%20first)%0A%20%20%20%200004%20%20%20%20%2032%20bit%20integer%20%2060000%20%20%20%20%20%20%20%20%20%20%20%20number%20of%20items%0A%20%20%20%200008%20%20%20%20%20unsigned%20byte%20%20%20%3F%3F%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%0A%20%20%20%200009%20%20%20%20%20unsigned%20byte%20%20%20%3F%3F%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%0A%20%20%20%20........%0A%20%20%20%20xxxx%20%20%20%20%20unsigned%20byte%20%20%20%3F%3F%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%0A%0A%20%20%20%20The%20labels%20values%20are%200%20to%209.%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20And%20for%20the%20images%0A%0A%20%20%20%20%60%60%60%0A%20%20%20%20%20IMAGE%20FILE%20FORMAT%0A%20%20%20%20%5Boffset%5D%20%5Btype%5D%20%20%20%20%20%20%20%20%20%20%5Bvalue%5D%20%20%20%20%20%20%20%20%20%20%5Bdescription%5D%0A%20%20%20%200000%20%20%20%20%2032%20bit%20integer%20%200x00000803(2051)%20magic%20number%0A%20%20%20%200004%20%20%20%20%2032%20bit%20integer%20%2060000%20%20%20%20%20%20%20%20%20%20%20%20number%20of%20images%0A%20%20%20%200008%20%20%20%20%2032%20bit%20integer%20%2028%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20number%20of%20rows%0A%20%20%20%200012%20%20%20%20%2032%20bit%20integer%20%2028%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20number%20of%20columns%0A%20%20%20%200016%20%20%20%20%20unsigned%20byte%20%20%20%3F%3F%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixel%0A%20%20%20%200017%20%20%20%20%20unsigned%20byte%20%20%20%3F%3F%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixel%0A%20%20%20%20........%0A%20%20%20%20xxxx%20%20%20%20%20unsigned%20byte%20%20%20%3F%3F%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pixel%0A%0A%20%20%20%20Pixels%20are%20organized%20row-wise.%20Pixel%20values%20are%200%20to%20255.%200%20means%20background%20(white)%2C%20255%20means%20foreground%20(black).%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20We%20can%20write%20python%20functions%20to%20extract%20the%20data%20and%20convert%20it%20into%20numpy%20arrays%2C%20one%20for%20the%20image%20data%20and%20one%20for%20the%20labels.%20We%20can%20then%20use%20the%20matplotlib%20library%20to%20display%20the%20images.%0A%0A%20%20%20%20%23%23%20Loading%20Labels%0A%0A%20%20%20%20We%20are%20going%20to%20use%20the%20python%20%60%60%60struct%60%60%60%20module%20to%20read%20the%20header%20data%20then%20skip%20the%20header%20and%20read%20the%20rest%20of%20the%20data.%20We%20can%20then%20convert%20the%20data%20into%20a%20numpy%20array.%0A%0A%20%20%20%20Note%20there%20is%20minimal%20error%20checking%20in%20this%20code%2C%20it%20is%20assumed%20the%20data%20is%20in%20the%20correct%20format%2C%20however%20we%20should%20be%20able%20to%20check%20the%20size%20of%20the%20data%20and%20the%20number%20of%20labels%20to%20ensure%20they%20match.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(np%2C%20struct)%3A%0A%20%20%20%20def%20load_mnist_labels(filename%3A%20str)%20-%3E%20np.ndarray%3A%0A%20%20%20%20%20%20%20%20with%20open(filename%2C%20%22rb%22)%20as%20f%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20magic%2C%20num%20%3D%20struct.unpack(%22%3EII%22%2C%20f.read(8))%0A%20%20%20%20%20%20%20%20%20%20%20%20labels%20%3D%20np.fromfile(f%2C%20dtype%3Dnp.uint8)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20len(labels)%20!%3D%20num%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20raise%20ValueError(f%22Expected%20%7Bnum%7D%20labels%2C%20but%20got%20%7Blen(labels)%7D%22)%0A%20%20%20%20%20%20%20%20return%20labels%0A%20%20%20%20return%20(load_mnist_labels%2C)%0A%0A%0A%40app.cell%0Adef%20_(DATASET_LOCATION%2C%20load_mnist_labels)%3A%0A%20%20%20%20%23%20We%20can%20now%20load%20the%20labels%20from%20both%20the%20datasets.%0A%0A%20%20%20%20train_labels%20%3D%20load_mnist_labels(DATASET_LOCATION%20%2B%20%22train-labels-idx1-ubyte%22)%0A%20%20%20%20test_labels%20%3D%20load_mnist_labels(DATASET_LOCATION%20%2B%20%22t10k-labels-idx1-ubyte%22)%0A%0A%20%20%20%20print(len(train_labels)%2C%20len(test_labels))%0A%20%20%20%20print(train_labels%5B0%5D%2C%20test_labels%5B0%5D)%0A%20%20%20%20return%20test_labels%2C%20train_labels%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20For%20the%20images%20we%20can%20do%20the%20same%20thing%2C%20not%20the%20header%20is%20a%20little%20different.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(DATASET_LOCATION%2C%20np%2C%20struct)%3A%0A%20%20%20%20def%20load_mnist_images(filename%3A%20str)%20-%3E%20np.ndarray%3A%0A%20%20%20%20%20%20%20%20with%20open(filename%2C%20%22rb%22)%20as%20f%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20magic%2C%20num%2C%20rows%2C%20cols%20%3D%20struct.unpack(%22%3EIIII%22%2C%20f.read(16))%0A%20%20%20%20%20%20%20%20%20%20%20%20images%20%3D%20np.fromfile(f%2C%20dtype%3Dnp.uint8).reshape(num%2C%20rows%2C%20cols)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20len(images)%20!%3D%20num%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20raise%20ValueError(f%22Expected%20%7Bnum%7D%20images%2C%20but%20got%20%7Blen(images)%7D%22)%0A%20%20%20%20%20%20%20%20return%20images%0A%0A%20%20%20%20%23%20We%20can%20now%20load%20the%20images%20from%20both%20the%20datasets.%0A%20%20%20%20train_images%20%3D%20load_mnist_images(DATASET_LOCATION%20%2B%20%22train-images-idx3-ubyte%22)%0A%20%20%20%20test_images%20%3D%20load_mnist_images(DATASET_LOCATION%20%2B%20%22t10k-images-idx3-ubyte%22)%0A%20%20%20%20return%20test_images%2C%20train_images%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Finally%20we%20can%20display%20the%20images%20using%20the%20matplotlib%20library.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(np%2C%20plt%2C%20test_images%2C%20test_labels%2C%20train_images%2C%20train_labels)%3A%0A%20%20%20%20def%20display_image(image%3A%20np.array%2C%20label%3A%20str)%20-%3E%20None%3A%0A%20%20%20%20%20%20%20%20plt.title(f%22Label%20%3A%20%7Blabel%7D%22)%0A%20%20%20%20%20%20%20%20plt.imshow(image%2C%20cmap%3D%22gray%22)%0A%20%20%20%20%20%20%20%20plt.show()%0A%0A%20%20%20%20%23%20We%20can%20now%20display%20the%20first%20image%20from%20the%20training%20dataset.%0A%0A%20%20%20%20display_image(train_images%5B0%5D%2C%20train_labels%5B0%5D)%0A%20%20%20%20display_image(test_images%5B0%5D%2C%20test_labels%5B0%5D)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20Conclusions%0A%0A%20%20%20%20We%20will%20use%20this%20data%20again%20in%20another%20example%20when%20we%20actually%20train%20a%20model%20with%20it.%20As%20mentioned%20in%20the%20introduction%20the%20MNIST%20dataset%20can%20also%20be%20downloaded%20using%20the%20torchvision%20library%20in%20PyTorch.%0A%0A%20%20%20%20%60%60%60python%0A%20%20%20%20import%20torch%0A%20%20%20%20from%20torchvision%20import%20datasets%0A%20%20%20%20from%20torchvision.transforms%20import%20ToTensor%0A%0A%20%20%20%20%23%20Download%20training%20data%20from%20open%20datasets.%0A%20%20%20%20training_data%20%3D%20datasets.MNIST(%0A%20%20%20%20%20%20%20%20root%3D%22data%22%2C%0A%20%20%20%20%20%20%20%20train%3DTrue%2C%0A%20%20%20%20%20%20%20%20download%3DTrue%2C%0A%20%20%20%20%20%20%20%20transform%3DToTensor()%2C%0A%20%20%20%20)%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20This%20will%20also%20convert%20the%20data%20to%20a%20tensor%20which%20is%20the%20format%20we%20need%20to%20use%20it%20in%20PyTorch.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20return%20(mo%2C)%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">80a29cf08385e8481010e5cbc14147a4</marimo-code-hash>
</body>
</html>

